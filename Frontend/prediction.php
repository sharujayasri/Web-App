<?php
header('Content-Type: application/json');

// Step 1: Retrieve the prediction result from the CSV or output generated by app.py
$csv_file = 'test_input.csv'; // Make sure this is the same file used in app.py for prediction
$prediction_file = 'predicted_Results.csv'; // The file where app.py saves prediction results

// Check if the prediction file exists
if (!file_exists($prediction_file)) {
    echo json_encode(["status" => "error", "message" => "Prediction file not found."]);
    exit;
}

// Step 2: Read the prediction result from the prediction_output.csv
$prediction_data = array_map('str_getcsv', file($prediction_file));

// Step 3: Process the prediction data
// Assuming the prediction result is the last column (update if needed)
$prediction = end($prediction_data[0]);  // Get the last column (prediction)
$probability = end($prediction_data[1]); // Get the probability value

// Step 4: Return the result as a JSON response
echo json_encode([
    "status" => "success",
    "prediction" => $prediction,
    "probability" => $probability
]);
?>
